<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PMP Exam Simulator</title>
  <style>
    /* Basic Reset */
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      background: #f4f4f4;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    header {
      background: #333;
      color: #fff;
      padding: 1rem;
      text-align: center;
    }
    main {
      flex: 1;
      padding: 1rem;
      max-width: 800px;
      width: 100%;
      margin: 1rem auto;
      background: #fff;
      border-radius: 4px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    #app > div {
      margin-bottom: 1.5rem;
    }
    .question {
      margin-bottom: 2rem;
    }
    .questionOptions {
      list-style: none;
      padding: 0;
    }
    .questionOptions li {
      margin-bottom: 1rem;
    }
    .feedback {
      font-weight: bold;
      margin-top: 1rem;
    }
    /* Button Styles */
    button {
      background: #333;
      color: #fff;
      border: none;
      padding: 0.8rem 1.2rem;
      cursor: pointer;
      border-radius: 4px;
      font-size: 1rem;
    }
    button:hover {
      opacity: 0.9;
    }
    /* Responsive adjustments */
    @media (max-width: 600px) {
      main {
        padding: 0.5rem;
        margin: 0.5rem;
      }
    }
    /* Minimalist select box styling */
    #chapterSelection label {
      margin-right: 0.5rem;
      font-weight: bold;
    }
    #chapterSelect {
      padding: 0.5rem;
      font-size: 1rem;
    }
    /* Timer styling */
    #timerDisplay {
      font-weight: bold;
      font-size: 1.1rem;
    }
  </style>
</head>
<body>
  <header>
    <h1>PMP Exam Simulator</h1>
  </header>
  <main>
    <div id="app">
      <div id="chapterSelection">
        <label for="chapterSelect">Select PMBOK Chapter:</label>
        <select id="chapterSelect"></select>
      </div>
      <div id="timerDisplay">
        Time Remaining: <span id="timeRemaining">00:00</span>
      </div>
      <div id="questionContainer"></div>
      <button id="nextButton" style="display:none;">Next Question</button>
      <div id="feedback" class="feedback"></div>
    </div>
  </main>

  <script>
    // Embedded exam data containing PMBOK chapters and questions.
    const examData = {
      "chapters": [
        {
          "name": "Chapter 1: Introduction",
          "questions": [
            {
              "question": "What is the primary purpose of the PMP exam?",
              "options": [
                "To test theoretical knowledge only",
                "To evaluate your practical project management skills by applying PMBOK guidelines",
                "To assess technical IT skills",
                "To refine general management theories"
              ],
              "correctIndex": 1,
              "explanation": "The PMP exam evaluates your ability to manage real-world project scenarios in line with PMBOK guidelines."
            },
            {
              "question": "Which document outlines the processes and knowledge areas used in project management?",
              "options": [
                "Project Charter",
                "PMBOK Guide",
                "Project Management Plan",
                "Risk Register"
              ],
              "correctIndex": 1,
              "explanation": "The PMBOK Guide outlines the processes and knowledge areas essential for project management."
            }
          ]
        },
        {
          "name": "Chapter 2: Planning",
          "questions": [
            {
              "question": "Which process group is primarily responsible for outlining the project schedule?",
              "options": [
                "Initiating",
                "Planning",
                "Executing",
                "Closing"
              ],
              "correctIndex": 1,
              "explanation": "Project scheduling and detailed planning are functions of the Planning process group."
            },
            {
              "question": "What is a key output of the Planning phase?",
              "options": [
                "Project Charter",
                "Project Schedule",
                "Status Report",
                "Contract Agreement"
              ],
              "correctIndex": 1,
              "explanation": "The project schedule is a key output during the planning process, detailing timelines and milestones."
            }
          ]
        }
      ]
    };

    let currentIndex = 0;
    let currentChapter = '';
    let timerInterval;
    let totalTime = 0;      // Total exam time in seconds for the selected chapter
    let timeRemaining = 0;  // Remaining time in seconds

    // Populate the chapter dropdown using the embedded exam data.
    function populateChapters() {
      const chapterSelect = document.getElementById('chapterSelect');
      if (examData && examData.chapters && examData.chapters.length > 0) {
        examData.chapters.forEach(chapter => {
          const option = document.createElement('option');
          option.value = chapter.name;
          option.textContent = chapter.name;
          chapterSelect.appendChild(option);
        });
        // Set default chapter selection and initialize the timer.
        chapterSelect.value = examData.chapters[0].name;
        currentChapter = examData.chapters[0].name;
        chapterSelect.addEventListener('change', e => {
          currentChapter = e.target.value;
          currentIndex = 0;
          startTimer();   // (Re)start the timer for the new chapter selection.
          showQuestion();
        });
        startTimer(); // Start timer for the default chapter.
        showQuestion();
      } else {
        document.getElementById('questionContainer').innerHTML =
          '<p>No chapters found in the exam data.</p>';
      }
    }

    // Display a single question from the selected chapter.
    function showQuestion() {
      const questionContainer = document.getElementById('questionContainer');
      const chapter = examData.chapters.find(ch => ch.name === currentChapter);
      if (!chapter || currentIndex >= chapter.questions.length) {
        questionContainer.innerHTML = '<p>You have completed all questions in this chapter!</p>';
        document.getElementById('nextButton').style.display = 'none';
        if (timerInterval) {
          clearInterval(timerInterval);
        }
        return;
      }
      const q = chapter.questions[currentIndex];
      questionContainer.innerHTML = `
        <div class="question">
          <p>${q.question}</p>
          <ul class="questionOptions">
            ${q.options.map((option, i) => `
              <li>
                <label>
                  <input type="radio" name="answer" value="${i}"> ${option}
                </label>
              </li>
            `).join('')}
          </ul>
          <button onclick="checkAnswer()">Submit Answer</button>
        </div>
      `;
      document.getElementById('feedback').textContent = '';
      document.getElementById('nextButton').style.display = 'none';
    }

    // Check the selected answer and provide instant feedback.
    function checkAnswer() {
      const selected = document.querySelector('input[name="answer"]:checked');
      const feedbackDiv = document.getElementById('feedback');
      if (!selected) {
        feedbackDiv.textContent = 'Please select an answer.';
        return;
      }
      const userAnswer = parseInt(selected.value, 10);
      const chapter = examData.chapters.find(ch => ch.name === currentChapter);
      const q = chapter.questions[currentIndex];

      if (userAnswer === q.correctIndex) {
        feedbackDiv.textContent = 'Correct! ' + (q.explanation || '');
      } else {
        feedbackDiv.textContent = 'Incorrect! ' + (q.explanation || '');
      }

      // Reveal the "Next Question" button after answer submission.
      document.getElementById('nextButton').style.display = 'block';
    }

    // Advance to the next question.
    document.getElementById('nextButton').addEventListener('click', () => {
      currentIndex++;
      showQuestion();
    });

    // Start or restart the exam timer based on the selected chapter's number of questions.
    function startTimer() {
      if (timerInterval) {
        clearInterval(timerInterval);
      }
      const chapter = examData.chapters.find(ch => ch.name === currentChapter);
      if (!chapter) return;
      // Calculate total exam time (in seconds): number of questions * 75.
      totalTime = chapter.questions.length * 75;
      timeRemaining = totalTime;
      updateTimerDisplay();

      timerInterval = setInterval(() => {
        timeRemaining--;
        if (timeRemaining <= 0) {
          clearInterval(timerInterval);
          timeRemaining = 0;
          updateTimerDisplay();
          examTimeOver();
        } else {
          updateTimerDisplay();
        }
      }, 1000);
    }

    // Update the displayed timer in a mm:ss format.
    function updateTimerDisplay() {
      const minutes = Math.floor(timeRemaining / 60);
      const seconds = timeRemaining % 60;
      document.getElementById('timeRemaining').textContent =
        (minutes < 10 ? "0" : "") + minutes + ":" + (seconds < 10 ? "0" : "") + seconds;
    }

    // End the exam when the timer runs out.
    function examTimeOver() {
      alert("Time's up! The exam will now end.");
      document.getElementById('questionContainer').innerHTML = "<p>Time's up! The exam is over.</p>";
      document.getElementById('feedback').textContent = "";
      document.getElementById('nextButton').style.display = "none";
    }

    // Initialize the exam simulation.
    populateChapters();
  </script>
</body>
</html>
